#2G/4G信令转换原型系统的设计与实现
杨庆龙 1500012956
## 绪论
由各大运营商管理的地面通信网络(以下简称地面网)是我们平时生活中使用最多的移动通信系统，但地面通信网存在信号覆盖面积小等缺点，导致其只能满足普通条件下的移动通信，而无法在例如海事救援等特殊环境下使用。而卫星通信网络(以下简称卫星网)则由于使用卫星进行信号收发的特点，能很好地解决地面通信网无法解决的通信网络覆盖问题，也是一个非常重要的通信网络。
卫星可依据卫星高度分为四类，即低轨卫星，中轨卫星，高轨卫星以及同步卫星。在本世纪初期，由于卫星发射的成本等问题，主要发展的卫星通信网大多由单星覆盖面积较大的中高轨卫星及同步卫星组成，低轨卫星主要承担中继等工作，很少直接构成通信网络。而中高轨卫星距离地面的高度太大，导致传输过程中的延时与误码率都远远高于地面网络，所以在这些通信系统中，大多不使用地面网络设计信令，而是选择针对卫星网络的特点，设计私有信令协议以满足实际通信需求。这也导致卫星网信令的时序信息等要素与地面网所使用的信令截然不同，进而导致其很难接入地面网，只能作为应对特殊通信环境的专用通信网络。
近几年，由于卫星产业商业化逐渐成熟，卫星发射成本大幅下降，使用具有低延迟大带宽等优势的近地卫星构建近地卫星网已成为可能。此外，由于近地卫星的通信条件已经接近地面网的极限情况，所以，修改成熟的地面商业信令而不是选择设计全新的信令协议可以有效地降低成本。此外，由于固移融合技术已经发展了很长一段时间，所以采用地面商业信令也能方便我们。
综上，低轨通信网使用成熟商业信令系统将能极大地方便卫星网接入地面网，以扩充用户数量，并促进商业推广。然而卫星网络带宽十分有限，所以传输3G信令或4G信令将不可避免地进行分片操作，又由于卫星网络的大延迟高误码等缺点，这将极大地影响系统性能。综上所述，使用简洁的2G信令将是低轨卫星网最好的选择。
## 需求分析
### 方案选择
要将使用2G信令的卫星网接入地面通信网，共有两种实现方式。
第一种为使用2G基站设备与核心网设备，再通过标准的固移融合技术接入到地面通信网络。然而，由于近地卫星能覆盖的区域十分有限，且移动速度很快，每时每刻都有大量用户在不同卫星的不同波束间切换，且已远远超出了商用2G核心网的计算能力。因此不使用该方法。
第二种为使用2G基站设备处理来自用户设备的数据，但使用4G核心网提供移动性管理以及其他通信服务，使用功能强大的4G核心网解决2G核心网不能解决的问题。这种方法需要通过实现一个网关处理2G与4G间的信令差异与数据差异。综上，最终采用第二种方式。
### 信令差异
通话是卫星通信网提供的基本功能，以下就分别以主叫与被叫流程分析2G与4G的信令差异。
#### 2G信令
##### 系统结构
2G系统结构如下图<!https://wenku.baidu.com/view/80b011eeccbff121dd3683e4.html>
###### 移动台(Mobile Station,MS)
移动台即用户接入移动通信网络的终端，主要由两部分构成，一是为用户提供无线电收发能力的移动设备(Mobile Equipment,ME)，二是用于进行身份验证的用户身份识别卡(Subscriber Identification Module,SIM)。
###### 基站收发信机(Base Transceiver Station,BTS)
基站收发信机与基站控制器共同组成基站，与用户进行无线电交流，但需要注意的是，基站收发机只负责无线电收发，并不具有信道管理等功能。
###### 基站控制器(Base Station Controller,BSC)
基站控制器具有控制基站收发信机进行信息收发的功能，处理所有与无线电管理的工作，例如小区切换，小区内无线资源管理等。
###### 移动业务交换中心(Mobile Service Switching Center,MSC)
移动业务交换中心为用户提供交换功能，即建立通话，传输短信等。由于通话过程中不可避免地会出现寻呼等情况，所以交换中心必须与拜访位置寄存器连接在一起，才能提供通话等服务。
###### MSC关口局(Gateway MSC)
由于一个MSC不可能覆盖全国范围内的所有移动通信服务，所以需要一个MSC关口局承担沟通跨越不同MSC的通信服务。
###### 拜访位置寄存器(Visitor Location Register,VLR)
拜访位置寄存器是一个存放用户数据的数据库，但需要注意的是VLR只是一个临时数据库，会随着用户访问情况的变化而变化，更多只是在通信过程中作为HLR的一个本地缓存，避免MSC的每一次服务都要查询HLR，提升系统性能。
###### 归属位置寄存器(Home Location Register,HLR)
归属位置寄存器是一个存储着整个网络中用户数据的数据库，用于向VLR提供用户信息。
###### 鉴权中心(Authentication Center,AC)
鉴权中心正如其名字，用于对请求服务与接受服务的用户依据SIM卡中的信息，对用户进行鉴权，避免非法用户占用网络资源。
###### 移动台设备识别寄存器(Equipment Identity Register,EIR)
移动台设备识别寄存器用于存储并鉴别MS的身份，避免因为对同一用户进行多次不必要的鉴权影响系统性能。
###### 操作维护中心(Operation and Maintenance Center,OMC)
操作维护中心为整个系统的控制界面，向工作人员提供一个系统设备的监控与控制的界面。
#### 主叫流程
主叫流程可粗略分为以下六部分子流程构成：
1. 控制信道建立流程：用于给MSC和MS建立专用的控制信道
2. 业务申请流程：MS向MSC发出业务建立请求
3. 鉴权/加密流程：MSC对MS进行鉴权
4. 呼叫建立流程：MSC认为MS合法，开始建立呼叫业务
5. 业务开始流程：业务正式开始，待被叫方也建立业务后，通话开始
6. 业务结束流程：通话结束后，回收信道资源
每个子流程的详细过程如下
##### 控制信道建立流程
1. MS向BTS请求信道，BTS向BSC请求信道
2. BSC发出激活信道命令，BTS反馈收到命令的指令
3. BSC发出立即指配命令，BTS和MS使用慢速随路控制信道(SACCH)和独立专用控制信道(SDCCH)建立立即指配信道
##### 业务申请流程
1. MS向BTS发出业务建立请求，BTS向BSC发出建立指示，BSC向MSC发出Complete Layer 3 Info
2. BTS向MS反馈业务建立请求
##### 鉴权/加密流程
1. MSC向MS发出鉴权请求，MS发出鉴权响应
2. MSC向BSC发出加密模式命令，BSC向BTS发出加密命令，BTS和MS间进行加密，MS向BSC报告加密完成，BSC向MSC报告加密模式完成
##### 呼叫建立流程
1. MS向MSC发起呼叫建立请求，MSC和MS开始启动呼叫进程
2. MSC向BSC发送指配请求，BSC激活BTS的SACCH和业务信道(TCH)，预先准备BSC和MS建立通信的专用信道，准备好后BTS反馈信道激活确认
3. BSC向MS发送指配命令，MS向BTS发送SABM信令，以确保链路层传输无误；之后BTS向BSC发送建立指示；BTS向MS回送一个UA帧，表示收到SABM信令
4. MS向BSC发送指配完成信令，BSC向MSC发送指配完成信令
5. 业务建立流程已完成，BSC和BTS释放为建立业务建立的临时信道
##### 业务开始流程
1. MSC向MS发出振铃信令，被叫方摘机后发送连接信令，MS反馈连接确认信令，通话开始
##### 业务结束流程
1. 通话结束后，MS向MSC发送拆线信令，MSC要求MS释放信道，MS释放完成后给MSC反馈释放完成信令
2. MSC指示BSC回收信道资源
#### 被叫流程
被叫流程可粗略分为以下六部分子流程构成：
1. 寻呼流程：MSC在系统中寻呼被叫MS
1. 控制信道建立流程：用于给MSC和MS建立专用的控制信道
3. 鉴权/加密流程：MSC对MS进行鉴权
4. 呼叫建立流程：MSC认为MS合法，开始建立呼叫业务
5. 业务开始流程：被叫方振铃并摘机，业务正式开始
6. 业务结束流程：通话结束后，回收信道资源
##### 寻呼流程
1. MSC依据VLR中的数据选择BSC，并向相应BSC发送寻呼命令，BSC再向所有BST发送寻呼命令，BST在寻呼信道内进行寻呼
##### 控制信道建立流程
1. MS收到寻呼信令后，向BTS请求信道，BTS向BSC请求信道
2. BSC发出激活信道命令，BTS反馈收到命令的指令
3. BSC发出立即指配命令，BTS和MS使用慢速随路控制信道(SACCH)和独立专用控制信道(SDCCH)建立立即指配信道
##### 鉴权/加密流程
1. 控制信道建立后，进入与主叫流程中相同的鉴权/加密流程
2. 鉴权通过后，MSC向MS发送呼叫建立信令，MS反馈呼叫确认
##### 呼叫建立流程
1. 被叫流程中的呼叫建立流程与主叫流程中的呼叫建立流程
##### 业务开始流程
1. MS向MSC发送振铃信令与连接信令，MSC反馈连接确认信令，待主叫方也建立连接后，通话开始
##### 业务结束流程
1. 通话结束后，进入和主叫流程一样的业务结束流程
###	4G信令
#### 系统结构
在4G网络中，用户被称为User Equipment(UE)，与eNB建立无线连接，再通过Evolved Packet Core(EPC)建立数据网络连接，最后通过IP Multimedia Subsystem(IMS)等多媒体服务提供架构实现通话服务。
##### EPC
<!EPC结构图>
Mobility Management Entity(MME)在EPC中扮演者控制节点的角色。其具有处理来自用户的NAS信令与来自eNB的S1AP信令的功能，此外，MME还具有信道管理，用户移动性管理等功能。
Home Subscriber Server(HSS)是LTE网络中存储用户的鉴权信息与位置信息的服务器，通过S6a接口与MME相连。

##### IMS
##### 主叫流程
##### 被叫流程
## 网关设计
信令流程差异，需要模拟核心网接口，与
## 软件实现
## 软件测试
## 展望
